<mat-card class="card page">
    <!-- Header -->
    <div class="page-header">
        <h2 class="page-title">Directores</h2>

        <div class="btn-row">
            <a mat-stroked-button color="primary" routerLink="/movies" aria-label="Volver a películas">
                <mat-icon>arrow_back</mat-icon>&nbsp;Volver
            </a>
            <button mat-raised-button color="primary" (click)="create()" aria-label="Crear director">
                <mat-icon>add</mat-icon>&nbsp;Nuevo
            </button>
        </div>
    </div>

    <mat-divider></mat-divider>

    <!-- Buscador -->
    <div class="search-field mt-12" style="max-width:420px;">
        <mat-form-field appearance="outline" class="w-100">
            <mat-label>Buscar directores</mat-label>
            <input matInput placeholder="Nombre, edad…" (keyup)="applyFilter($event.target.value)"
                aria-label="Buscar directores" />
            <button *ngIf="filter?.length" matSuffix mat-icon-button aria-label="Limpiar búsqueda"
                (click)="applyFilter('')">
                <mat-icon>close</mat-icon>
            </button>
        </mat-form-field>
    </div>

    <!-- Estados -->
    <div *ngIf="loading" class="state">
        <span class="pulse"></span>&nbsp;Cargando…
    </div>
    <div *ngIf="error" class="state" style="color:#b00020;">
        <mat-icon>error_outline</mat-icon>&nbsp;{{ error }}
    </div>

    <!-- Tabla -->
    <div *ngIf="!loading && !error">
        <div class="table-wrap">
            <table mat-table [dataSource]="data" matSort class="mat-elevation-z2" style="width:100%;">
                <!-- Id -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>#</th>
                    <td mat-cell *matCellDef="let d">{{ d.id }}</td>
                </ng-container>

                <!-- Nombre -->
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</th>
                    <td mat-cell *matCellDef="let d" style="font-weight:500">{{ d.name }}</td>
                </ng-container>

                <!-- Edad -->
                <ng-container matColumnDef="age">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Edad</th>
                    <td mat-cell *matCellDef="let d">{{ d.age ?? '—' }}</td>
                </ng-container>

                <!-- Activo -->
                <ng-container matColumnDef="active">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Activo</th>
                    <td mat-cell *matCellDef="let d">
                        <mat-chip-set>
                            <mat-chip [color]="d.active ? 'primary' : 'warn'" [selected]="true" appearance="outlined">
                                <mat-icon>{{ d.active ? 'check_circle' : 'cancel' }}</mat-icon>&nbsp;
                                {{ d.active ? 'Sí' : 'No' }}
                            </mat-chip>
                        </mat-chip-set>
                    </td>
                </ng-container>

                <!-- Acciones -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef style="text-align:right;">Acciones</th>
                    <td mat-cell *matCellDef="let d" style="text-align:right;">
                        <button mat-icon-button color="primary" (click)="edit(d.id)" aria-label="Editar">
                            <mat-icon>edit</mat-icon>
                        </button>
                        <button mat-icon-button color="warn" (click)="remove(d.id)" aria-label="Eliminar">
                            <mat-icon>delete</mat-icon>
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

                <!-- Estado vacío -->
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                        <div class="state">No hay directores que coincidan con “{{ filter || '' }}”.</div>
                    </td>
                </tr>
            </table>
        </div>

        <mat-paginator class="mt-12" [pageSize]="8" [pageSizeOptions]="[5,8,12,20]" showFirstLastButtons
            aria-label="Selector de página">
        </mat-paginator>
    </div>
</mat-card>